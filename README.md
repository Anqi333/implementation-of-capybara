Permissionless cryptocurrencies like Bitcoin face significant scalability challenges. Payment channels (PCs) have emerged as a promising solution, offering scalability enhancements for permissionless blockchains through off-chain transactions, thereby reducing the burden on the primary blockchain. While advantageous, the fund depletion potential reduces users' ability to pay and even forces PCs to close, restricting scalability. Current methodologies for countering this rely on rebalancing. Shaduf, as the latest promising rebalancing work, simplifies the construction of previous work and enhances usability. However, Shaduf requires Turing-complete script languages that most cryptocurrencies lack. Moreover, as the existing rebalancing work only deals with the depleted channels, they provide limited throughput improvement.

In response, we introduce Capybara, an innovative rebalancing protocol that effectively mitigates channel depletion by preventing skewness introduced by multi-hop payments, thereby enhancing network resilience. Notably, Capybara requires minimal blockchain functionalities (the capacity for signing and verifying digital signatures), ensuring wider applicability. Additionally, it runs without depending on commonly trusted assumptions (e.g., the nodes are always online).

Capybara is implemented using generalized channels as the underlying payment channel protocol and is tested on the network simulated from a real Lightning Network (LN) snapshot. The running cost is demonstrated with implementations respectively based on ECDSA and Schnorr signatures in the 'basic_implementation' project. Further, we conduct comparative simulations of Capybara, Shaduf, and Revive on this real LN testnet within the 'simulation_in_testnet' project. It is important to note that the provided implementation of Capybara is conceptual and not yet industry-ready. Before real-world application, a more thorough coding and security analysis based on our protocol, is essential.